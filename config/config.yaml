jira:
  base_url: "https://jira.synnex.com"
  # Prefer environment variable auth:
  #   export RACKBRAIN_JIRA_PAT="..."
  # If you really need to put a token here, keep it out of git.
  pat: ""
  pat_env: "RACKBRAIN_JIRA_PAT"

rules:
  files:
    - "config/rules/generic_rules.yaml"
    - "config/rules/workflows_telnet_console.yaml"
    - "config/rules/workflows_ilom_console.yaml"
    - "config/rules/dimm_rules.yaml"
    - "config/rules/pci_rules.yaml"
    - "config/rules/workflows_psu_ac_loss.yaml"
    - "config/rules/workflows_bios_deferred_update.yaml"
    - "config/rules/workflows_snbench_200g_jumper.yaml"
    - "config/rules/untested_rules.yaml"
    - "config/rules/approval_rules.yaml"
    - "config/rules/cinder_verification.yaml"
    - "config/rules/precheck_rules.yaml"

processing:
  # Configuration for ticket processing workflow
  required_combined_text_contains: "This ticket generated by EVE BOT"
  assign_to: "austin.lin@hyvesolutions.com"
  transition_to: "In Progress"
  allowed_statuses:
    - "Open"
    - "In Progress"
  # Optional: override timer DB path; relative paths are resolved under RACKBRAIN_HOME.
  # timer_db_path: "state/rackbrain_state.sqlite"

polling:
 # Polling configuration for auto-processing tickets
  enabled: true  # Set to true to enable polling mode
  poll_interval_seconds: 10  # How often to poll (2 minutes)
  lookback_hours: 12  # How far back to search each cycle
  project_key: "MFGS"  # Jira project key
  allowed_statuses:
    - "Open"
    - "In Progress"
  max_workers: 4
  max_results: 35
  jql: |
    project IN (MFGS)
    AND Location = Fremont
    AND (
      created >= -12h
      OR updated >= -12h
    )

    AND (
      status = Open
      OR (status = "In Progress" AND assignee = currentUser())
    )
    AND summary !~ "WOODY: HOP26*"
    AND summary !~ "Hopper26SFE*"
    AND summary !~ "WOODY: HEATWAVE*"
    AND summary !~ "NPI*"
    AND summary !~ "WOODY: HOP56*"
    ORDER BY created DESC, summary DESC, cf[15143] DESC, updated DESC

  extra_queries:
    - name: approval_ack_old_tickets
      only_rule_ids: ["approval_request_ack"]
      max_results: 20
      jql: |
        project IN (MFGS)
        AND Location = Fremont
        AND status = "In Progress"
        AND updated >= -1h
        AND assignee = currentUser()
        AND comment !~ "RB:approval_request_ack:v1"
        ORDER BY updated DESC


#project IN (MFGS) AND status = Open AND updated >= -1w AND Location = Fremont AND summary !~ "WOODY: HOP26EN*" AND summary !~ "Hopper26SFE*" AND summary !~ "WOODY: HEATWAVE*" AND summary !~ "NPI*" AND summary !~ "WOODY: HOP56*" ORDER BY created DESC, summary DESC, cf[15143] DESC, updated DESC
#project = MFGS AND status = Open AND updated >= -1h ORDER BY updated DESC
logging:
  # Logging configuration
  enabled: true  # Enable logging to file
  log_dir: "logs"  # Directory to store log files (relative to project root)
  log_file: "rackbrain_processed.log"  # Main log file for processed tickets
  log_format: "json"  # "json" or "text" - JSON is easier to parse, text is human-readable
  rotate_daily: true  # Create new log file each day (YYYY-MM-DD suffix)
