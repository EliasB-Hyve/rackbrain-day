# Rule YAML reference (for rule authors): config/rules/RULES_YAML_REFERENCE.md
# action:
#   type: comment_only
#   assign_to: "someone@hyvesolutions.com"
#   reassign_to: "another@hyvesolutions.com"
#   transition_to: "In Progress"
#   comment_template: |
#     Approved. Proceed.
#     [RB]



- id: approval_request_ack
  name: "Approval request acknowledgement"
  description: >
    When the latest Jira comment includes 'Requesting approval'
    and the commenter is on the approved list, post an acknowledgement comment.
  allow_high_slt_attempts: true
  priority: 100

  scope:
    jira_latest_comment_text:
      regex: "(?i)(request(ing)? approval|need approval|approval.*doa|doa.*approval|need te review|please review)"


    jira_latest_comment_author:
      - "jonathan.gaitantrigueros@hyvesolutions.com"
      - "Kao.Saeteurn@hyvesolutions.com"
      - "michelle.hernandez2@hyvesolutions.com"
      - "colin.steele@hyvesolutions.com"
      - "Osbaldo.Ramirez@hyvesolutions.com"
      - "HuuT@hyvesolutions.com"
      - "ducleminh.nguyen@hyvesolutions.com"
      - "Eric.Van@hyvesolutions.com"
      - "jasmeet.singh2@hyvesolutions.com"
      - "yinyin.phyo@hyvesolutions.com"
      - "tommy.nguyen@hyvesolutions.com"
      - "thaih@hyvesolutions.com"
      - "SumeerB@hyvesolutions.com"
      - "JohnyS@hyvesolutions.com"
      - "htetaung.shinn@hyvesolutions.com"
      - "Phat.Dao@hyvesolutions.com"
      - "bao.pham@hyvesolutions.com"
      - "khoat@hyvesolutions.com"
      - "trung.nguyen@hyvesolutions.com"
      - "igor.zhidilev@hyvesolutions.com"
      - "MarilouD@hyvesolutions.com"
      - "Ravinder.Singh@hyvesolutions.com"
      - "SteveCh@hyvesolutions.com"
      - "Manuel.Collado@hyvesolutions.com"

    # Prevent duplicate ack on the same ticket
    jira_comments_text:
      not_contains: "RB:approval_request_ack:v1"

  patterns:
    - type: regex
      value: ".*"

  action:
    type: "comment_only"
    reassign_to: "{jira_latest_comment_author}"
    comment_template: |
      Approved. Proceed.
      [[RB:approval_request_ack:v1]]


