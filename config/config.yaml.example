# RackBrain Configuration Template
# Copy this file to config/config.yaml and fill in your values

jira:
  base_url: "https://jira.synnex.com"
  # Jira Personal Access Token (PAT)
  # Repo convention: PAT is configured here and all code reads it from config.
  # Keep this file local and do not commit real credentials.
  pat: "your_pat_here"
  # Optional legacy mode (not used when jira.pat is set):
  # pat_env: "RACKBRAIN_JIRA_PAT"

rules:
  files:
    - "config/rules/generic_rules.yaml"
    # Add location-specific rules:
    # - "config/rules/mississippi_rules.yaml"

processing:
  # Optional: require this literal substring to appear in Jira summary+description
  # before any rules are evaluated (useful to only process EVEBOT-generated tickets).
  required_combined_text_contains: "This ticket generated by EVE BOT"

  # User to assign ticket to initially (before processing)
  assign_to: "your.email@hyvesolutions.com"
  
  # User to reassign ticket to after processing (technician)
  reassign_to: "technician.email@hyvesolutions.com"
  
  # Status to transition ticket to
  transition_to: "In Progress"
  
  # Only process tickets in these statuses
  allowed_statuses:
    - "Open"
    - "In Progress"

polling:
  # Enable/disable polling (not currently used, but reserved)
  enabled: false
  
  # How often to poll for new tickets (seconds)
  poll_interval_seconds: 120
  
  # How far back to search each cycle (hours)
  lookback_hours: 1
  
  # Jira project key
  project_key: "MFGS"
  
  # Statuses to search for
  allowed_statuses:
    - "Open"
    - "In Progress"
  
  # Concurrent ticket processing
  max_workers: 4
  
  # Maximum tickets to fetch per poll
  max_results: 200
  
  # Optional: Custom JQL query (overrides auto-generated)
  # jql: 'project = MFGS AND status = Open AND updated >= -1h ORDER BY updated DESC'
  #
  # Optional: Extra JQL queries that run in the SAME poll cycle, but with a
  # restricted ruleset so widened windows don't affect normal triage rules.
  # See: config/CONFIG_REFERENCE.md
  #
  # Example: run ONLY the approval acknowledgement rule against older tickets
  # (removes any "created >= ..." restriction but still requires a recent update).
  #
  # extra_queries:
  #   - name: "approval_ack_old_tickets"
  #     only_rule_ids: ["approval_request_ack"]
  #     max_results: 200
  #     jql: 'project = MFGS AND Location = Fremont AND updated >= -1h AND status = "In Progress" AND assignee = currentUser() ORDER BY updated DESC'

logging:
  # Enable file logging
  enabled: true
  
  # Directory to store log files
  log_dir: "logs"
  
  # Log file name (date suffix added if rotate_daily is true)
  log_file: "rackbrain_processed.log"
  
  # Log format: "json" (machine-readable) or "text" (human-readable)
  log_format: "json"
  
  # Create new log file each day
  rotate_daily: true

  # Append-only history of which tickets matched each rule_id.
  # Stored as a single text file grouped by rule.
  rule_match_history:
    enabled: true
    file: "rackbrain_rule_matches.txt"
    include_dry_runs: false

